name: Test Kubernetes Runner

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build-on-k8s:
    name: Run on K8s and Check Version
    runs-on: self-hosted
    steps:
      - name: üïµÔ∏è Explore Runner Filesystem
        run: |
          echo "================================================="
          echo "||           LISTING ENVIRONMENT VARIABLES     ||"
          echo "================================================="
          env | sort
          
          echo
          echo "================================================="
          echo "||          LISTING ROOT DIRECTORY (/)         ||"
          echo "================================================="
          ls -la /

          echo
          echo "================================================="
          echo "||      LISTING HOME DIRECTORY (/home/runner)    ||"
          echo "================================================="
          # This command will not fail even if the directory doesn't exist.
          ls -la /home/runner || echo "Directory /home/runner not found."
      - name: üöÄ Test Runner
        run: |
          echo "üéâ Job is running on a self-hosted runner in Kubernetes!"
          echo "Runner Name: $RUNNER_NAME"

      - name: üîç Get Runner Version
        run: |
          echo "Getting the runner version from the script..."
          cd /home/runner/actions-runner
          ./run.sh --version
